package com.audit_management_app.auditmanagement_DAM.domain.services;

import com.audit_management_app.auditmanagement_DAM.domain.projects.Vulnerability;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;

import java.util.List;

public interface IVulnerabilityRepository extends JpaRepository<Vulnerability,Integer> {
    // Găsește vulnerabilități asociate unui proiect
    @Query("SELECT v FROM Vulnerability v WHERE v.project.projectId = :projectId")
    List<Vulnerability> findByProjectId(@Param("projectId") Integer projectId);

    // Găsește vulnerabilități asociate unui proiect pe baza severității
    @Query("SELECT v FROM Vulnerability v WHERE v.project.projectId = :projectId AND v.severity = :severity")
    List<Vulnerability> findByProjectIdAndSeverity(@Param("projectId") Integer projectId, @Param("severity") Vulnerability.Severity severity);

    // Găsește vulnerabilități asociate unui proiect pe baza statusului
    @Query("SELECT v FROM Vulnerability v WHERE v.project.projectId = :projectId AND v.status = :status")
    List<Vulnerability> findByProjectIdAndStatus(@Param("projectId") Integer projectId, @Param("status") Vulnerability.Status status);

    // Găsește toate vulnerabilitățile asociate unui raport
    @Query("SELECT v FROM Vulnerability v WHERE v.report.reportId = :reportId")
    List<Vulnerability> findByReportId(@Param("reportId") Integer reportId);
}
